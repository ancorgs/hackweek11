<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Presence2</title>
  <link href="stylesheets/application.css" media="all" rel="stylesheet">
  <script src="javascripts/jquery.min.js"></script>
  <script src="javascripts/adapter.js"></script>
  <script src="javascripts/janus.js"></script>
  <script src="javascripts/data.js"></script>
  <script src="javascripts/ui.js"></script>
  <script src="javascripts/photo.js"></script>
  <script src="javascripts/video.js"></script>
</head>
<body>

<h2>They</h2>
<div id="peers"></div>
<h2>You</h2>
<div id="local">
  <canvas style="display:none"></canvas>
  <img src="images/user_placeholder.png">
  <video style="display:none" muted="muted"></video>
  <button id="video-on">Start video</button>
  <button id="video-off" style="display:none">Stop video</button>
</div>

<script>
  var janusVideoRoom = 1001;
  var janusDataRoom = 1002;
  // Global janus instance and URL for both video and data
  // If needed it could be splited into 2 different janus servers
  var janus = null;
  var janusURL = "http://" + window.location.hostname + ":8088/janus";
  // To share the media stream for pictures and video
  var mediaStream;
  // Just a prototype, generate a random username
  var username = Math.random().toString(36).substring(7);

  $(document).ready(function() {
    // Initialize the library (console debug enabled)
    Janus.init({debug: true});
    window.initPhoto(320);
    window.openDataChannel(username, function() { window.takePictures(10000) });

    $('#video-on').click(function() {openVideoChannel(username)});
    $('#video-off').click(closeVideoChannel);
  });
</script>

</body></html>
